T0 = 20.3;
T200 = 10;
alpha = 0.0515;
beta = 4.970679476477;
z0 = 200;
z1 = linspace(0, 200, 500);
z2 = linspace(200, 1000, 500);
z3 = linspace(1000, 1500, 500);
A = [0^2, 0, 1; 
     200^2, 200, 1; 
     2*200, 1, 0];
B = [T0; T200; -alpha];
coeffs = A \ B;
a = coeffs(1);
b = coeffs(2);
c = coeffs(3);
T1 = a*z1.^2 + b*z1 + c;
T2 = T200 - beta * log(1 + (z2 - 200) / z0);
T3 = ones(size(z3)) * 2;
z = [z1, z2, z3];
T = [T1, T2, T3];
figure;
plot(T, z, 'k-', 'LineWidth', 1.5);
hold on;
xlabel('Temperature (T) [Â°C]','FontSize', 24);
ylabel('Depth (z) [m]','FontSize', 24);
title('Temperature Profile with Thermocline');
set(gca, 'YDir', 'reverse');
grid on;
xlim([min(T), max(T)]);
ylim([0, max(z)]);
annotation('arrow', [0.12, 0.12], [0.9, 0.2], 'LineWidth', 1.5);
annotation('arrow', [0.1, 0.9], [0.9, 0.9], 'LineWidth', 1.5);
hold off;
